//made by HJCD studios
/*
 Saves:
 font - font-size
 ff - font family
 text - last saved text
 color - text color
 */
var data = {
    "FontSize":"20",
    "FontFamily":"sans-serif",
    "Color":"black",
    "LastText":"",
    "Theme":"light",
    "C":{
        "Height":screen.height,
        "Width":screen.width
    }
};
function OnStart() {
    if (localStorage.getItem("Data") != null) {
        data = JSON.parse(localStorage.getItem("Data"));
        alert(JSON.stringify(data));
    } else {
        localStorage.setItem("Data",JSON.stringify(data));
    }
    LoadConfigs();
}
function LoadConfigs() {
    document.getElementsByClassName("Editor")[CheckTheme()].style.fontSize = data.FontSize + "px";
    document.getElementsByClassName("Editor")[CheckTheme()].style.fontFamily = data.FontFamily;
    document.getElementsByClassName("Editor")[CheckTheme()].style.color = data.Color;
    document.getElementsByClassName("Editor")[CheckTheme()].value = data.LastText;
    document.getElementsByClassName("Output")[CheckTheme()].style.width = data.C.Width + "px";
    document.getElementsByClassName("Output")[CheckTheme()].style.height = data.C.Height + "px";
    document.getElementsByClassName("Theme")[CheckTheme()].value = data.Theme;
    document.getElementsByClassName("Home")[CheckTheme()].style.display = "block";
    if (CheckTheme() == 0) {
        document.getElementsByClassName("Editor")[CheckTheme()].style.borderColor = "rgb(81,81,81)";
        document.getElementsByClassName("Editor")[CheckTheme()].style.backgroundColor = "white";
        document.body.style.backgroundColor = "white";
    } else {
        document.getElementsByClassName("Editor")[CheckTheme()].style.borderColor = "white";
        document.getElementsByClassName("Editor")[CheckTheme()].style.backgroundColor = "rgb(81,81,81)";
        document.body.style.backgroundColor = "rgb(81,81,81)";
    }
}
function SaveConfigs() {
    localStorage.setItem("Data",JSON.stringify(data));
}
function download(filename,text) {
    var element = document.createElement('a');
    element.setAttribute('href','data:text/html;charset=utf-8,' + encodeURIComponent(text));
    element.setAttribute('download',filename);
    document.body.appendChild(element);
    element.click();
    document.body.removeChild(element);
}
function Run() {
    var a = document.getElementsByClassName("Output")[CheckTheme()].contentWindow.document;
    a.open();
    a.write(document.getElementsByClassName("Editor")[CheckTheme()].value);
    a.close();
}
function NewHtml() {
    if (confirm("Any Un-Saved Changes Will Be Lost\nContinue?")) {
        document.getElementsByClassName("Editor")[CheckTheme()].value = "<html>\n  <head>\n  <title></title>\n  </head>\n  <body>\n </body>\n</html>";
        Set("LS");
    }
}
function CF() {
    document.getElementById("File").click();
}
function ReadFile(f) {
    var r = new FileReader();
    r.onload = function(e) {
        document.getElementsByClassName("Editor")[CheckTheme()].value = e.target.result;
        Set("LS");
        SaveConfigs();
    };
    r.readAsText(f);
}
function CFL() {
    var fname = prompt("Enter file name");
    if (fname != null) {
        if (fname.length >= 1) {
            download(fname,document.getElementsByClassName("Editor")[CheckTheme()].value);
        }
    }
}
function Show(cn) {
    document.getElementsByClassName(cn)[CheckTheme()].style.display = "block";
}
function Hide(cn) {
    document.getElementsByClassName(cn)[CheckTheme()].style.display = "none";
}
function Settings() {
    if (document.getElementsByClassName("Settings")[CheckTheme()].style.display == "none") {
        Show("Settings");
        Hide("Home");
    } else {
        Hide("Settings");
        Show("Home");
    }
}
function CheckTheme() {
    if (data.Theme == "light") {
        return 0;
    } else {
        return 1;
    }
}
function Set(type,other) {
    switch (type) {
        case "FS":
            var a = prompt("Enter Font-Size in pixels",data.FontSize);
            if (a != null) {
                if (!isNaN(a)) {
                    data.FontSize = a;
                } else {
                    alert("Font-Size can only contain numbers");
                }
            }
            break;
        case "FF":
            var a = prompt("Enter Font-Family",data.FontFamily);
            if (a != null) {
                data.FontFamily = a;
            }
            break;
        case "C":
            var a = prompt("Enter:\nColor Name\nHex code\nor rgb(255,255,255)",data.Color);
            if (a != null) {
                data.Color = a;
            }
            break;
        case "W":
            var a = prompt("Enter Width in pixels",data.C.Width);
            if (a != null) {
                if (!isNaN(a)) {
                    data.C.Width = a;
                } else {
                    alert("Output Width can only contain numbers");
                }
            }
            break;
        case "H":
            var a = prompt("Enter Height in pixels",data.C.Height);
            if (a != null) {
                if (!isNaN(a)) {
                    data.C.Height = a;
                } else {
                    alert("Output Height can only contain numbers");
                }
            }
            break;
        case "LS":
            data.LastText = document.getElementsByClassName("Editor")[CheckTheme()].value;
            break;
        case "T":
            document.getElementsByClassName("Home")[CheckTheme()].style.display = "none";
            data.Theme = other;
        break;
        case "R":
            if (confirm("Reset to default?")) {
                data = GetDef());
                location.reload();
            }
        break;
    }
    LoadConfigs();
    SaveConfigs();
}
function LoadWebsite() {
    var xml = new XMLHttpRequest();
    if (confirm("Any Un-Saved Changes Will Be Lost\nContinue?")) {
        var url = prompt("Enter URL\n(Absolute)");
        if (url != null) {
            if (url.length >= 1) {
                xml.open("GET",url,true);
                xml.onreadystatechange = function() {
                    if (xml.readyState == 4) {
                        if (xml.status == 200) {
                            document.getElementsByClassName("Editor")[CheckTheme()].value = xml.responseText;
                            Set("LS");
                        } else {
                            alert("Failed!\nReady State: " + xml.readyState + "\nStatus: " + xml.status + "\nResponse:\n" + xml.responseText);
                        }
                    }
                }
                xml.send(null);
            } else {
                alert("URL cannot be empty");
            }
        }
    }
}
function GetDef() {
    var dat = {
        "FontSize":"20",
        "FontFamily":"sans-serif",
        "Color":"black",
        "LastText":"",
        "Theme":"light",
        "C":{
            "Height":screen.height,
            "Width":screen.width
        }
    };
    return JSON.stringify(dat);
}
